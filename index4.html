<html>

<head>
  <style>
    .row {
      display: block;
      border: 1px solid yellow; /* only for debuggin, remove */
    }
    .cell {
      display: inline-block;
    }
    </style>
  <script async defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()"
    onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
  <script>
    function start() {
      // Initializes the client with the API key and the Translate API.
      gapi.client.init({
        'apiKey': 'AIzaSyBRW6aMCSm4aoo636LnVIExSMYWuow7IV4',
        'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
      }).then(function (response) {
        // console.log(response);
      });
    };

    // Loads the JavaScript client library and invokes `start` afterwards.
    function handleClientLoad() {
      gapi.load('client', start);
      // execute();
    }

    function execute() {
      return gapi.client.sheets.spreadsheets.get({
        "spreadsheetId": "1xou6_yJOAtKxzcugUWuE1JpzIhPqI0WMJN05M-U1sJc",
        "includeGridData": true
      }).then(function (response) {
        // Handle the results here (response.result has the parsed body).
        console.log("Response", response.result);
        buildHtml(response.result);
      },
        function (err) { console.error("Execute error", err); });
    }
    
    var htmlAccumulator = '';
    function buildHtml(data) {
      htmlAccumulator += "<div>";
        let maxRows = 0;
        for (const rowData in data.sheets[0].data[0].rowData) {
          // merge same items and increase row width
          let newCell = [];
          let possition = 0;
          let rows = 1;
          for (const cell in data.sheets[0].data[0].rowData[rowData].values) {
              if (typeof newCell[possition - 1] === 'undefined' || newCell[possition - 1].formattedValue != data.sheets[0].data[0].rowData[rowData].values[cell].formattedValue) {
                newCell[possition] = {};
                newCell[possition].formattedValue = data.sheets[0].data[0].rowData[rowData].values[cell].formattedValue;
                newCell[possition].rowSpawn = 1;
                ++possition;
                rows = 1;
              } else {
                newCell[possition - rows].rowSpawn = rows + 1;
                ++rows;
                ++possition;
              }
          }
          // console.log('tasio1:');
          // console.dir(newCell);

          // calculate max rows
          let rowCounter = 0;
          for (const cell in newCell) {
            rowCounter = rowCounter + cell.rowSpawn;
          }
          if (rowCounter > maxRows) {
            maxRows = rowCounter;
          }


          // lines
          htmlAccumulator += "<div class='row'>";
          for (const cell in data.sheets[0].data[0].rowData[rowData].values) {
            htmlAccumulator += "<div class='cell'>";
            htmlAccumulator += data.sheets[0].data[0].rowData[rowData].values[cell].formattedValue;
            htmlAccumulator += "</div>";
              // console.log(htmlAccumulator);
              // console.log(data.sheets[0].data[0].rowData[rowData].values[cell].formattedValue);
          }
          htmlAccumulator += "</div>";
        }
      htmlAccumulator += "</div>";
      document.getElementById('results').innerHTML = htmlAccumulator;
      // console.log(htmlAccumulator);
    }

  </script>
</head>

<body>
  <div id="results">
    <!-- <div class="row">
      <div class="cell"></div>
      <div class="cell">2-Aug-2021</div>
      <div class="cell">9-Aug-2021</div>
      <div class="cell">16-Aug-2021</div>
      <div class="cell">23-Aug-2021</div>
    </div>
    <div class="row">
      <div class="cell">Person1</div>
      <div class="cell">Project Name one</div>
      <div class="cell">Project Name one</div>
      <div class="cell">Project name two</div>
      <div class="cell">Project name two</div>
    </div> -->
  </div>
  <button onclick="execute()">execute</button>
</body>

</html>